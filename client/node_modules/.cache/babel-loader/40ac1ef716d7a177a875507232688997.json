{"ast":null,"code":"import _objectSpread from\"C:/Users/kandw/OneDrive/Desktop/Ecommerce/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/kandw/OneDrive/Desktop/Ecommerce/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useSelector}from'react-redux';import axios from'../axios';import Loading from'./Loading.js';import{Badge,Button,Modal,Table}from'react-bootstrap';import Pagination from'./Pagination';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function OrdersAdminPage(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),orders=_useState2[0],setOrders=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var products=useSelector(function(state){return state.products;});var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),orderToShow=_useState6[0],setOrderToShow=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),show=_useState8[0],setShow=_useState8[1];var handleClose=function handleClose(){return setShow(false);};function markShipped(orderId,ownerId){axios.patch(\"/orders/\".concat(orderId,\"/mark-shipped\"),{ownerId:ownerId}).then(function(_ref){var data=_ref.data;return setOrders(data);}).catch(function(e){return console.log(e);});}function showOrder(productsObj){var productsToShow=products.filter(function(product){return productsObj[product._id];});productsToShow=productsToShow.map(function(product){var productCopy=_objectSpread({},product);productCopy.count=productsObj[product._id];delete productCopy.description;return productCopy;});setShow(true);setOrderToShow(productsToShow);}useEffect(function(){setLoading(true);axios.get('/orders').then(function(_ref2){var data=_ref2.data;setLoading(false);setOrders(data);}).catch(function(e){setLoading(false);});},[]);if(loading){return/*#__PURE__*/_jsx(Loading,{});}if(orders.length===0){return/*#__PURE__*/_jsx(\"h1\",{className:\"text-center pt-4\",children:\"No orders yet\"});}function TableRow(_ref3){var _id=_ref3._id,count=_ref3.count,owner=_ref3.owner,total=_ref3.total,status=_ref3.status,products=_ref3.products,address=_ref3.address;{orders.map(function(order){var _order$owner;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order._id}),/*#__PURE__*/_jsx(\"td\",{children:(_order$owner=order.owner)===null||_order$owner===void 0?void 0:_order$owner.name}),/*#__PURE__*/_jsx(\"td\",{children:order.count}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",order.total]}),/*#__PURE__*/_jsx(\"td\",{children:order.address}),/*#__PURE__*/_jsx(\"td\",{children:order.status==='processing'?/*#__PURE__*/_jsx(Button,{size:\"sm\",onClick:function onClick(){var _order$owner2;return markShipped(order._id,(_order$owner2=order.owner)===null||_order$owner2===void 0?void 0:_order$owner2.id);},children:\"Mark as shipped\"}):/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:\"Shipped\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{style:{cursor:'pointer'},onClick:function onClick(){return showOrder(order.products);},children:[\"View Order \",/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-eye\"})]})})]});});}}return/*#__PURE__*/_jsxs(_Fragment,{children:[\" \",/*#__PURE__*/_jsxs(Table,{responsive:true,striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Client name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Items\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Order Total\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Address\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:/*#__PURE__*/_jsx(Pagination,{data:orders,RenderComponent:TableRow,pageLimit:1,dataLimit:10,tablePagination:true})})]}),/*#__PURE__*/_jsxs(Modal,{show:show,onHide:handleClose,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Order Details\"})}),orderToShow.map(function(order){return/*#__PURE__*/_jsxs(\"div\",{className:\"order-details__container d-flex justify-content-around py-2\",children:[/*#__PURE__*/_jsx(\"img\",{src:order.pictures[0].url,style:{maxWidth:100,height:100,objectFit:\"cover\"}}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsxs(\"span\",{children:[order.count,\" x \"]}),order.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Price:$\",Number(order.price)*order.count]})]});}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:handleClose,children:\"Close\"})})]})]});}export default OrdersAdminPage;","map":{"version":3,"names":["React","useEffect","useState","useSelector","axios","Loading","Badge","Button","Modal","Table","Pagination","OrdersAdminPage","orders","setOrders","loading","setLoading","products","state","orderToShow","setOrderToShow","show","setShow","handleClose","markShipped","orderId","ownerId","patch","then","data","catch","e","console","log","showOrder","productsObj","productsToShow","filter","product","_id","map","productCopy","count","description","get","length","TableRow","owner","total","status","address","order","name","id","cursor","pictures","url","maxWidth","height","objectFit","Number","price"],"sources":["C:/Users/kandw/OneDrive/Desktop/Ecommerce/client/src/components/OrdersAdminPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { useSelector } from 'react-redux';\nimport axios from '../axios';\nimport Loading from './Loading.js'\nimport { Badge, Button, Modal, Table } from 'react-bootstrap';\nimport Pagination from './Pagination';\nfunction OrdersAdminPage() {\n    const [orders,setOrders]=useState([]);\n    const [loading,setLoading]=useState(false);\n    const products=useSelector(state=>state.products);\n    const [orderToShow,setOrderToShow]=useState([]);\n    const [show,setShow]=useState(false);\n\n    const handleClose=()=>setShow(false);\n\n    function markShipped(orderId,ownerId){\n        axios.patch(`/orders/${orderId}/mark-shipped`,{ownerId}).then(({data})=>setOrders(data))\n        .catch((e)=>console.log(e));\n\n    }\n\n    function showOrder(productsObj){\n        let productsToShow=products.filter((product)=>productsObj[product._id]);\n        productsToShow=productsToShow.map((product)=>{\n            const productCopy={...product};\n            productCopy.count=productsObj[product._id];\n            delete productCopy.description;\n            return productCopy;\n        });\n        setShow(true);\n        setOrderToShow(productsToShow);\n    }\n\n    useEffect(()=>{\n        setLoading(true);\n        axios.get('/orders').then(({data})=>{\n            setLoading(false);\n            setOrders(data);\n        }).catch((e)=>{\n            setLoading(false);\n        }\n    )},[]);\n\n        if(loading){\n            return <Loading />\n        }\n        if(orders.length===0){\n            return <h1 className='text-center pt-4'>No orders yet</h1>\n        }\n\n        function TableRow({_id,count,owner,total,status,products,address}){\n            {orders.map(order=>(<tr>\n                <td>{order._id}</td>\n                <td>{order.owner?.name}</td>\n                <td>{order.count}</td>\n                <td>${order.total}</td>\n                <td>{order.address}</td>\n                <td>{order.status==='processing' ?(<Button size=\"sm\" onClick={()=>markShipped(order._id,order.owner?.id)}>Mark as shipped</Button>):<Badge bg=\"success\">Shipped</Badge>}</td>\n                <td><span style={{cursor:'pointer'}} onClick={()=>showOrder(order.products)}>\n                    View Order <i className=\"fa fa-eye\"></i>\n                    </span></td>\n            </tr>))}\n        }\n\n  return<> <Table responsive striped bordered hover>\n        <thead>\n            <tr>\n                <th>#</th>\n                <th>Client name</th>\n                <th>Items</th>\n                {/* <th>Status</th> */}\n                {/* <th>Date</th> */}\n                <th>Order Total</th>\n                <th>Address</th>\n                {/* <th>&nbsp;</th> */}\n            </tr>\n        </thead>\n        <tbody>\n            <Pagination data={orders} RenderComponent={TableRow} pageLimit={1} dataLimit={10} tablePagination={true} />\n        </tbody>\n    </Table>\n    <Modal show={show} onHide={handleClose}>\n        <Modal.Header closeButton>\n            <Modal.Title>Order Details</Modal.Title>\n        </Modal.Header>\n        {orderToShow.map(order=>(\n            <div className='order-details__container d-flex justify-content-around py-2'>\n                <img src={order.pictures[0].url} style={{maxWidth:100,height:100,objectFit:\"cover\"}} />\n                <p>\n                    <span>{order.count} x </span>{order.name}\n                </p>\n                <p>Price:${Number(order.price)*order.count}</p>\n            </div>\n        ))}\n        <Modal.Footer>\n            <Button variant='secondary' onClick={handleClose}>Close</Button>\n        </Modal.Footer>\n    </Modal>\n    </>\n}\n\nexport default OrdersAdminPage"],"mappings":"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"},"metadata":{},"sourceType":"module"}