{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Admin/Desktop/new-ecommerce-main/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/Admin/Desktop/new-ecommerce-main/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{useNavigate}from'react-router-dom';import'./NewProduct.css';import{useCreateProductMutation}from'../services/appApi';import{Alert,Col,Row,Container,Form,Button}from'react-bootstrap';import{Link}from'react-router-dom';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function NewProduct(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),description=_useState4[0],setDescription=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),price=_useState6[0],setPrice=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),category=_useState8[0],setCategory=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),images=_useState10[0],setImages=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),imgToRemove=_useState12[0],setImgToRemove=_useState12[1];var navigate=useNavigate();var _useCreateProductMuta=useCreateProductMutation(),_useCreateProductMuta2=_slicedToArray(_useCreateProductMuta,2),createProduct=_useCreateProductMuta2[0],_useCreateProductMuta3=_useCreateProductMuta2[1],isError=_useCreateProductMuta3.isError,error=_useCreateProductMuta3.error,isLoading=_useCreateProductMuta3.isLoading,isSuccess=_useCreateProductMuta3.isSuccess;function handleRemoveImg(imgObj){setImgToRemove(imgObj.public_id);axios.delete(\"/images/\".concat(imgObj.public_id)).then(function(res){setImgToRemove(null);setImages(function(prev){return prev.filter(function(img){return img.public_id!==imgObj.public_id;});});}).catch(function(e){return console.log(e);});}function handleSubmit(e){e.preventDefault();if(!name||!description||!price||!category||!images.length){return alert(\"Please fill out all the fields\");}createProduct({name:name,description:description,price:price,category:category,images:images}).then(function(_ref){var data=_ref.data;console.log(data);if(data.length>0){setTimeout(function(){navigate(\"/\");},1500);}});}function showWidget(){var widget=window.cloudinary.createUploadWidget({cloudName:'dv9tdfjnw',uploadPreset:\"cnubwvsa\"},function(error,result){if(!error&&result.event===\"success\"){setImages(function(prev){return[].concat(_toConsumableArray(prev),[{url:result.info.url,public_id:result.info.public_id}]);});}});widget.open();}return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,className:\"new-product--container\",children:/*#__PURE__*/_jsxs(Form,{style:{width:\"100%\"},onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mb-4 mt-4\",children:\"Create a product\"}),isSuccess&&/*#__PURE__*/_jsx(Alert,{variant:\"success\",children:\"Product created with success\"}),isError&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:error.data}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Product name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Enter product name\",value:name,required:true,onChange:function onChange(e){return setName(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Product Description\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"textarea\",placeholder:\"Product description\",style:{height:\"100px\"},value:description,required:true,onChange:function onChange(e){return setDescription(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Price($)\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"Price($)\",value:price,required:true,onChange:function onChange(e){return setPrice(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",onChange:function onChange(e){return setCategory(e.target.value);},children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Category\"}),/*#__PURE__*/_jsxs(Form.Select,{children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,selected:true,children:\"-- Select One --\"}),/*#__PURE__*/_jsx(\"option\",{value:\"technology\",children:\"Technology\"}),/*#__PURE__*/_jsx(\"option\",{value:\"tablets\",children:\"Tablets\"}),/*#__PURE__*/_jsx(\"option\",{value:\"phones\",children:\"Phones\"}),/*#__PURE__*/_jsx(\"option\",{value:\"laptops\",children:\"Laptops\"})]})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Button,{type:\"button\",onClick:showWidget,children:\"Upload Images\"}),/*#__PURE__*/_jsx(\"div\",{className:\"images-preview-container\",children:images.map(function(image){return/*#__PURE__*/_jsxs(\"div\",{className:\"image-preview\",children:[/*#__PURE__*/_jsx(\"img\",{src:image.url}),imgToRemove!==image.public_id&&/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-times-circle\",onClick:function onClick(){return handleRemoveImg(image);}})]});})})]}),/*#__PURE__*/_jsx(Form.Group,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:isLoading||isSuccess,children:\"Create Product\"})})]})}),/*#__PURE__*/_jsx(Col,{md:6,className:\"new-product__image--container\"})]})});}export default NewProduct;","map":{"version":3,"names":["React","useState","useNavigate","useCreateProductMutation","Alert","Col","Row","Container","Form","Button","Link","axios","NewProduct","name","setName","description","setDescription","price","setPrice","category","setCategory","images","setImages","imgToRemove","setImgToRemove","navigate","createProduct","isError","error","isLoading","isSuccess","handleRemoveImg","imgObj","public_id","delete","then","res","prev","filter","img","catch","e","console","log","handleSubmit","preventDefault","length","alert","data","setTimeout","showWidget","widget","window","cloudinary","createUploadWidget","cloudName","uploadPreset","result","event","url","info","open","width","target","value","height","map","image"],"sources":["C:/Users/Admin/Desktop/new-ecommerce-main/client/src/pages/NewProduct.js"],"sourcesContent":["import React, { useState } from 'react'\nimport {useNavigate} from 'react-router-dom'\nimport './NewProduct.css'\nimport { useCreateProductMutation } from '../services/appApi';\nimport { Alert,Col,Row,Container,Form,Button } from 'react-bootstrap';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\n\nfunction NewProduct() {\n  const [name,setName]=useState(\"\");\n  const [description,setDescription]=useState(\"\");\n  const [price,setPrice]=useState(\"\");\n  const [category,setCategory]=useState(\"\"); \n  const [images,setImages]=useState([]);\n  const [imgToRemove,setImgToRemove]=useState(null);\n  const navigate=useNavigate();\n  const [createProduct,{isError,error,isLoading,isSuccess}]=useCreateProductMutation();\n\n\n  function handleRemoveImg(imgObj){\n    setImgToRemove(imgObj.public_id);\n    axios.delete(`/images/${imgObj.public_id}`)\n    .then((res)=>{\n      setImgToRemove(null);\n      setImages((prev)=>prev.filter((img)=>img.public_id!==imgObj.public_id));\n    }).catch((e)=>console.log(e))\n  }\n\n  function handleSubmit(e){\n    e.preventDefault();\n    if(!name || !description || !price || !category || !images.length){\n      return alert(\"Please fill out all the fields\");\n    }\n    createProduct({name,description,price,category,images}).then(({data})=>{\n      console.log(data);\n      if(data.length>0){\n        setTimeout(()=>{\n          navigate(\"/\");\n        },1500)\n      }\n    })\n  }\n\n  function showWidget(){\n    const widget=window.cloudinary.createUploadWidget(\n      {\n        cloudName:'dv9tdfjnw',\n        uploadPreset:\"cnubwvsa\",\n      },\n      (error,result)=>{\n        if(!error && result.event===\"success\"){\n          setImages((prev)=>[...prev,{url:result.info.url,public_id:result.info.public_id}])\n        }\n      }\n    );\n    widget.open();\n  }\n\n  return (\n    <Container>\n      <Row>\n        <Col md={6} className=\"new-product--container\">\n          <Form style={{width:\"100%\"}} onSubmit={handleSubmit}>\n                    <h1 className='mb-4 mt-4'>Create a product</h1>\n                    {isSuccess && <Alert variant=\"success\">Product created with success</Alert>}\n                    {isError && <Alert variant='danger'>{error.data}</Alert>}\n                    <Form.Group className='mb-3'>\n                        <Form.Label>Product name</Form.Label>\n                        <Form.Control type=\"text\" placeholder=\"Enter product name\" value={name} required onChange={(e)=>setName(e.target.value)} />\n                    </Form.Group>\n                    <Form.Group className='mb-3'>\n                        <Form.Label>Product Description</Form.Label>\n                        <Form.Control type=\"textarea\" placeholder=\"Product description\" style={{height:\"100px\"}} value={description} required onChange={(e)=>setDescription(e.target.value)} />\n                    </Form.Group>\n                    <Form.Group className='mb-3'>\n                        <Form.Label>Price($)</Form.Label>\n                        <Form.Control type=\"number\" placeholder=\"Price($)\" value={price} required onChange={(e)=>setPrice(e.target.value)} />\n                    </Form.Group>\n                    <Form.Group className='mb-3' onChange={(e)=>setCategory(e.target.value)}>\n                        <Form.Label>Category</Form.Label>\n                        <Form.Select>\n                          <option disabled selected>-- Select One --</option>\n                          <option value=\"technology\">Technology</option>\n                          <option value=\"tablets\">Tablets</option>\n                          <option value=\"phones\">Phones</option>\n                          <option value=\"laptops\">Laptops</option>\n                        </Form.Select>\n                    </Form.Group>\n                    <Form.Group className='mb-3'>\n                        <Button type=\"button\" onClick={showWidget}>Upload Images</Button>\n                        <div className='images-preview-container'>\n                          {images.map((image)=>(\n                            <div className='image-preview'>\n                              <img src={image.url} />\n                              {/* Add icon for removing  */}\n                          {imgToRemove!==image.public_id &&   <i className='fa fa-times-circle' onClick={()=>handleRemoveImg(image)}></i>}\n                            </div>\n                          ))}\n                        </div>\n                    </Form.Group>\n                    <Form.Group className='mb-3'>\n                        <Button type=\"submit\" disabled={isLoading || isSuccess}>Create Product</Button>\n                    </Form.Group>\n                </Form>\n        </Col>\n        <Col md={6} className=\"new-product__image--container\"></Col>\n\n      </Row>\n    </Container>\n  )\n}\n\nexport default NewProduct"],"mappings":"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"},"metadata":{},"sourceType":"module"}