{"ast":null,"code":"import _toConsumableArray from\"C:/Users/kandw/OneDrive/Desktop/Ecommerce/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/kandw/OneDrive/Desktop/Ecommerce/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import'./NewProduct.css';import{useUpdateProductMutation}from'../services/appApi';import{Alert,Col,Row,Container,Form,Button}from'react-bootstrap';import{Link,useParams}from'react-router-dom';import axios from'../axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EditProductPage(){var _useParams=useParams(),id=_useParams.id;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),description=_useState4[0],setDescription=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),price=_useState6[0],setPrice=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),category=_useState8[0],setCategory=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),images=_useState10[0],setImages=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),imgToRemove=_useState12[0],setImgToRemove=_useState12[1];var navigate=useNavigate();var _useUpdateProductMuta=useUpdateProductMutation(),_useUpdateProductMuta2=_slicedToArray(_useUpdateProductMuta,2),updateProduct=_useUpdateProductMuta2[0],_useUpdateProductMuta3=_useUpdateProductMuta2[1],isError=_useUpdateProductMuta3.isError,error=_useUpdateProductMuta3.error,isLoading=_useUpdateProductMuta3.isLoading,isSuccess=_useUpdateProductMuta3.isSuccess;useEffect(function(){axios.get('/products/'+id).then(function(_ref){var data=_ref.data;var product=data.product;setName(product.name);setDescription(product.description);setCategory(product.category);setImages(product.pictures);setPrice(product.price);}).catch(function(e){return console.log(e);});},[id]);function handleRemoveImg(imgObj){setImgToRemove(imgObj.public_id);axios.delete(\"/images/\".concat(imgObj.public_id)).then(function(res){setImgToRemove(null);setImages(function(prev){return prev.filter(function(img){return img.public_id!==imgObj.public_id;});});}).catch(function(e){return console.log(e);});}function handleSubmit(e){e.preventDefault();if(!name||!description||!price||!category||!images.length){return alert(\"Please fill out all the fields\");}updateProduct({id:id,name:name,description:description,price:price,category:category,images:images}).then(function(_ref2){var data=_ref2.data;console.log(data);if(data.length>0){setTimeout(function(){navigate(\"/\");},1500);}});}function showWidget(){var widget=window.cloudinary.createUploadWidget({cloudName:'dv9tdfjnw',uploadPreset:\"cnubwvsa\"},function(error,result){if(!error&&result.event===\"success\"){setImages(function(prev){return[].concat(_toConsumableArray(prev),[{url:result.info.url,public_id:result.info.public_id}]);});}});widget.open();}return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,className:\"new-product--container\",children:/*#__PURE__*/_jsxs(Form,{style:{width:\"100%\"},onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mb-4 mt-4\",children:\"Edit product\"}),isSuccess&&/*#__PURE__*/_jsx(Alert,{variant:\"success\",children:\"Product Updated\"}),isError&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:error.data}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Product name\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Enter product name\",value:name,required:true,onChange:function onChange(e){return setName(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Product Description\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"textarea\",placeholder:\"Product description\",style:{height:\"100px\"},value:description,required:true,onChange:function onChange(e){return setDescription(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Price($)\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"number\",placeholder:\"Price($)\",value:price,required:true,onChange:function onChange(e){return setPrice(e.target.value);}})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",onChange:function onChange(e){return setCategory(e.target.value);},children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Category\"}),/*#__PURE__*/_jsxs(Form.Select,{value:category,children:[/*#__PURE__*/_jsx(\"option\",{disabled:true,selected:true,children:\"-- Select One --\"}),/*#__PURE__*/_jsx(\"option\",{value:\"technology\",children:\"Technology\"}),/*#__PURE__*/_jsx(\"option\",{value:\"tablets\",children:\"Tablets\"}),/*#__PURE__*/_jsx(\"option\",{value:\"phones\",children:\"Phones\"}),/*#__PURE__*/_jsx(\"option\",{value:\"laptops\",children:\"Laptops\"})]})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Button,{type:\"button\",onClick:showWidget,children:\"Upload Images\"}),/*#__PURE__*/_jsx(\"div\",{className:\"images-preview-container\",children:images.map(function(image){return/*#__PURE__*/_jsxs(\"div\",{className:\"image-preview\",children:[/*#__PURE__*/_jsx(\"img\",{src:image.url}),imgToRemove!==image.public_id&&/*#__PURE__*/_jsx(\"i\",{className:\"fa fa-times-circle\",onClick:function onClick(){return handleRemoveImg(image);}})]});})})]}),/*#__PURE__*/_jsx(Form.Group,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:isLoading||isSuccess,children:\"Update Product\"})})]})}),/*#__PURE__*/_jsx(Col,{md:6,className:\"new-product__image--container\"})]})});}export default EditProductPage;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useUpdateProductMutation","Alert","Col","Row","Container","Form","Button","Link","useParams","axios","EditProductPage","id","name","setName","description","setDescription","price","setPrice","category","setCategory","images","setImages","imgToRemove","setImgToRemove","navigate","updateProduct","isError","error","isLoading","isSuccess","get","then","data","product","pictures","catch","e","console","log","handleRemoveImg","imgObj","public_id","delete","res","prev","filter","img","handleSubmit","preventDefault","length","alert","setTimeout","showWidget","widget","window","cloudinary","createUploadWidget","cloudName","uploadPreset","result","event","url","info","open","width","target","value","height","map","image"],"sources":["C:/Users/kandw/OneDrive/Desktop/Ecommerce/client/src/pages/EditProductPage.js"],"sourcesContent":["import React, { useState,useEffect } from 'react'\nimport {useNavigate} from 'react-router-dom'\nimport './NewProduct.css'\nimport {useUpdateProductMutation } from '../services/appApi';\nimport { Alert,Col,Row,Container,Form,Button } from 'react-bootstrap';\nimport { Link,useParams } from 'react-router-dom';\nimport axios from '../axios';\n\nfunction EditProductPage() {\n    const {id}=useParams();\n  const [name,setName]=useState(\"\");\n  const [description,setDescription]=useState(\"\");\n  const [price,setPrice]=useState(\"\");\n  const [category,setCategory]=useState(\"\"); \n  const [images,setImages]=useState([]);\n  const [imgToRemove,setImgToRemove]=useState(null);\n  const navigate=useNavigate();\n  const [updateProduct,{isError,error,isLoading,isSuccess}]=useUpdateProductMutation();\n\n\n    useEffect(()=>{\n        axios.get('/products/'+id).then(({data})=>{\n            const product=data.product;\n            setName(product.name);\n            setDescription(product.description);\n            setCategory(product.category);\n            setImages(product.pictures);\n            setPrice(product.price);\n        })\n        .catch((e)=>console.log(e));\n    },[id]);\n\n\n  function handleRemoveImg(imgObj){\n    setImgToRemove(imgObj.public_id);\n    axios.delete(`/images/${imgObj.public_id}`)\n    .then((res)=>{\n      setImgToRemove(null);\n      setImages((prev)=>prev.filter((img)=>img.public_id!==imgObj.public_id));\n    }).catch((e)=>console.log(e))\n  }\n\n  function handleSubmit(e){\n    e.preventDefault();\n    if(!name || !description || !price || !category || !images.length){\n      return alert(\"Please fill out all the fields\");\n    }\n    updateProduct({id,name,description,price,category,images}).then(({data})=>{\n      console.log(data);\n      if(data.length>0){\n        setTimeout(()=>{\n          navigate(\"/\");\n        },1500)\n      }\n    })\n  }\n\n  function showWidget(){\n    const widget=window.cloudinary.createUploadWidget(\n      {\n        cloudName:'dv9tdfjnw',\n        uploadPreset:\"cnubwvsa\",\n      },\n      (error,result)=>{\n        if(!error && result.event===\"success\"){\n          setImages((prev)=>[...prev,{url:result.info.url,public_id:result.info.public_id}])\n        }\n      }\n    );\n    widget.open();\n  }\n\n  return (\n    <Container>\n      <Row>\n        <Col md={6} className=\"new-product--container\">\n          <Form style={{width:\"100%\"}} onSubmit={handleSubmit}>\n                    <h1 className='mb-4 mt-4'>Edit product</h1>\n                    {isSuccess && <Alert variant=\"success\">Product Updated</Alert>}\n                    {isError && <Alert variant='danger'>{error.data}</Alert>}\n                    <Form.Group className='mb-3'>\n                        <Form.Label>Product name</Form.Label>\n                        <Form.Control type=\"text\" placeholder=\"Enter product name\" value={name} required onChange={(e)=>setName(e.target.value)} />\n                    </Form.Group>\n                    <Form.Group className='mb-3'>\n                        <Form.Label>Product Description</Form.Label>\n                        <Form.Control type=\"textarea\" placeholder=\"Product description\" style={{height:\"100px\"}} value={description} required onChange={(e)=>setDescription(e.target.value)} />\n                    </Form.Group>\n                    <Form.Group className='mb-3'>\n                        <Form.Label>Price($)</Form.Label>\n                        <Form.Control type=\"number\" placeholder=\"Price($)\" value={price} required onChange={(e)=>setPrice(e.target.value)} />\n                    </Form.Group>\n                    <Form.Group className='mb-3' onChange={(e)=>setCategory(e.target.value)}>\n                        <Form.Label>Category</Form.Label>\n                        <Form.Select value={category}>\n                          <option disabled selected>-- Select One --</option>\n                          <option value=\"technology\">Technology</option>\n                          <option value=\"tablets\">Tablets</option>\n                          <option value=\"phones\">Phones</option>\n                          <option value=\"laptops\">Laptops</option>\n                        </Form.Select>\n                    </Form.Group>\n                    <Form.Group className='mb-3'>\n                        <Button type=\"button\" onClick={showWidget}>Upload Images</Button>\n                        <div className='images-preview-container'>\n                          {images.map((image)=>(\n                            <div className='image-preview'>\n                              <img src={image.url} />\n                              {/* Add icon for removing  */}\n                          {imgToRemove!==image.public_id &&   <i className='fa fa-times-circle' onClick={()=>handleRemoveImg(image)}></i>}\n                            </div>\n                          ))}\n                        </div>\n                    </Form.Group>\n                    <Form.Group className='mb-3'>\n                        <Button type=\"submit\" disabled={isLoading || isSuccess}>Update Product</Button>\n                    </Form.Group>\n                </Form>\n        </Col>\n        <Col md={6} className=\"new-product__image--container\"></Col>\n\n      </Row>\n    </Container>\n  )\n}\n\nexport default EditProductPage"],"mappings":"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"},"metadata":{},"sourceType":"module"}